<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
<title>BhaashaBuddy â€“ Learn Marathi</title>
<link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800;900&family=Noto+Sans+Devanagari:wght@400;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="css/styles.css">
</head>
<body>
<div class="phone">

  <!-- ===================== HOME SCREEN ===================== -->
  <div class="screen active" id="screen-home">
    <div class="topbar">
      <h1>BhaashaBuddy ğŸ‡®ğŸ‡³</h1>
      <div class="sub">Learn Marathi â€¢ à¤®à¤°à¤¾à¤ à¥€ à¤¶à¤¿à¤•à¤¾</div>
    </div>
    <div class="search-wrap">
      <div class="search-box">
        <span class="search-icon">ğŸ”</span>
        <input type="text" id="home-search" placeholder="Search English, Hindi or Roman..." oninput="handleHomeSearch(this.value)">
      </div>
    </div>

    <div id="search-results-area" style="display:none">
      <div class="section-label">Search Results</div>
      <div class="search-results" id="search-results-list"></div>
    </div>

    <div id="categories-area">
      <div class="section-label">Phrase Categories</div>
      <div class="cat-grid">
        <div class="cat-card" style="--cat-color:#2B6CB0" onclick="openCategory('greetings')">
          <span class="cat-icon">ğŸ‘‹</span>
          <span class="cat-name">Greetings</span>
          <span class="cat-count">12 phrases</span>
        </div>
        <div class="cat-card" style="--cat-color:#D69E2E" onclick="openCategory('travel')">
          <span class="cat-icon">ğŸš—</span>
          <span class="cat-name">Travel</span>
          <span class="cat-count">18 phrases</span>
        </div>
        <div class="cat-card" style="--cat-color:#C05621" onclick="openCategory('food')">
          <span class="cat-icon">ğŸ½ï¸</span>
          <span class="cat-name">Food & Dining</span>
          <span class="cat-count">15 phrases</span>
        </div>
        <div class="cat-card" style="--cat-color:#805AD5" onclick="openCategory('shopping')">
          <span class="cat-icon">ğŸ›ï¸</span>
          <span class="cat-name">Shopping</span>
          <span class="cat-count">10 phrases</span>
        </div>
        <div class="cat-card" style="--cat-color:#E53E3E" onclick="openCategory('emergency')">
          <span class="cat-icon">ğŸš¨</span>
          <span class="cat-name">Emergency</span>
          <span class="cat-count">8 phrases</span>
        </div>
        <div class="cat-card" style="--cat-color:#38A169" onclick="openCategory('numbers')">
          <span class="cat-icon">ğŸ”¢</span>
          <span class="cat-name">Numbers</span>
          <span class="cat-count">20 phrases</span>
        </div>
      </div>
    </div>
  </div>

  <!-- ===================== PHRASE LIST SCREEN ===================== -->
  <div class="screen" id="screen-phrases">
    <div class="back-btn" onclick="goBack()">â† <span id="phrase-screen-title">Greetings</span></div>
    <div class="section-label" id="phrase-section-label">PHRASES</div>
    <div class="phrase-list" id="phrase-list"></div>
  </div>

  <!-- ===================== RESULT SCREEN ===================== -->
  <div class="screen" id="screen-result">
    <div class="back-btn" onclick="goBackFromResult()">â† Back</div>
    <div class="result-card">
      <div class="english-label">You searched</div>
      <div class="result-input-display" id="result-input-display"></div>
      <button class="speaker-btn" onclick="speakMarathi()" title="Pronounce">ğŸ”Š</button>
      <div class="result-devanagari" id="result-devanagari"></div>
      <div class="result-roman" id="result-roman"></div>
      <button class="save-btn" id="save-btn" onclick="savePhrase()">Save Phrase</button>
    </div>
    <div style="padding: 0 20px;">
      <div class="section-label">Similar Phrases</div>
      <div class="phrase-list" id="similar-phrases"></div>
    </div>
  </div>

  <!-- ===================== DICTIONARY SCREEN ===================== -->
  <div class="screen" id="screen-dictionary">
    <div class="topbar">
      <h1>Dictionary</h1>
      <div class="sub">English â†’ Marathi</div>
    </div>
    <div class="search-wrap">
      <div class="search-box">
        <span class="search-icon">ğŸ”</span>
        <input type="text" id="dict-search" placeholder="Search words..." oninput="handleDictSearch(this.value)">
      </div>
    </div>
    <div class="dict-list" id="dict-list"></div>
  </div>

  <!-- ===================== SAVED SCREEN ===================== -->
  <div class="screen" id="screen-saved">
    <div class="topbar">
      <h1>Saved</h1>
      <div class="sub">Your bookmarked phrases</div>
    </div>
    <div id="saved-list-wrap"></div>
  </div>

  <!-- ===================== CHAPTERS SCREEN ===================== -->
  <div class="screen" id="screen-chapters">
    <div class="topbar">
      <h1>Lessons ğŸ“š</h1>
      <div class="sub">281 chapters â€¢ learnmarathiwithkaushik.com</div>
    </div>
    <div class="search-wrap">
      <div class="search-box">
        <span class="search-icon">ğŸ”</span>
        <input type="text" id="chapters-search" placeholder="Search lessons..." oninput="handleChaptersSearch(this.value)">
      </div>
    </div>
    <div id="chapters-loading" style="display:none;text-align:center;padding:40px 20px;color:var(--text-muted);font-weight:700;">
      <div style="font-size:32px;margin-bottom:12px;">â³</div>
      Loading lessons...
    </div>
    <div id="chapters-error" style="display:none;text-align:center;padding:40px 20px;">
      <div style="font-size:36px;margin-bottom:12px;">âš ï¸</div>
      <div style="font-weight:800;color:var(--text);margin-bottom:6px;">Server not running</div>
      <div style="font-size:12px;color:var(--text-muted);font-weight:600;">Run <code style="background:var(--border);padding:2px 6px;border-radius:4px;">python server.py</code> to load chapters</div>
    </div>
    <div class="dict-list" id="chapters-list" style="padding: 0 20px;"></div>
  </div>

  <!-- ===================== CHAPTER DETAIL SCREEN ===================== -->
  <div class="screen" id="screen-chapter-detail">
    <div class="back-btn" onclick="goBackFromChapter()">â† <span id="chapter-detail-back-label">Lessons</span></div>
    <div style="padding: 0 20px 20px;">
      <div id="chapter-detail-loading" style="text-align:center;padding:40px 0;color:var(--text-muted);font-weight:700;display:none;">
        <div style="font-size:32px;margin-bottom:12px;">â³</div>Loading...
      </div>
      <div id="chapter-detail-content" style="display:none;">
        <div style="background:var(--primary-light);border-radius:12px;padding:14px 16px;margin-bottom:16px;">
          <div style="font-size:11px;font-weight:800;color:var(--primary);text-transform:uppercase;letter-spacing:0.8px;margin-bottom:4px;">Chapter <span id="chapter-detail-id"></span></div>
          <div id="chapter-detail-title" style="font-size:17px;font-weight:900;color:var(--text);line-height:1.4;"></div>
        </div>
        <div id="chapter-detail-body" style="
          background:var(--card);
          border-radius:var(--radius);
          padding:20px;
          box-shadow:var(--shadow);
          font-size:14px;
          line-height:1.8;
          color:var(--text);
          font-weight:600;
          white-space:pre-wrap;
          word-break:break-word;
        "></div>
        <a id="chapter-detail-link" href="#" target="_blank" style="
          display:block;
          margin-top:14px;
          text-align:center;
          font-size:13px;
          font-weight:700;
          color:var(--primary);
          padding:12px;
          background:var(--primary-light);
          border-radius:50px;
          text-decoration:none;
        ">ğŸ”— Open original lesson</a>
      </div>
    </div>
  </div>

  <!-- ===================== SETTINGS SCREEN ===================== -->
  <div class="screen" id="screen-settings">
    <div class="topbar">
      <h1>Settings</h1>
    </div>
    <div class="settings-section">
      <div class="settings-label">Offline Data</div>
      <div class="settings-card">
        <div class="settings-row">
          <div class="settings-row-left">
            <div class="settings-row-title">Enable Offline Mode</div>
            <div class="settings-row-sub">Use app without internet</div>
          </div>
          <div class="toggle" id="offline-toggle" onclick="toggleOffline()"></div>
        </div>
      </div>

      <div class="settings-label">Available Languages</div>
      <div class="settings-card">
        <div class="settings-row">
          <div class="settings-row-left">
            <div class="settings-row-title">Marathi</div>
            <div class="settings-row-sub">Downloaded (120 MB)</div>
          </div>
          <div class="lang-badge"><span class="lang-check">âœ“</span></div>
        </div>
        <div class="settings-row">
          <div class="settings-row-left">
            <div class="settings-row-title">Kannada</div>
            <div class="settings-row-sub">Coming soon</div>
          </div>
          <button class="download-btn" onclick="showToast('Kannada coming soon!')">Download</button>
        </div>
        <div class="settings-row">
          <div class="settings-row-left">
            <div class="settings-row-title">Tamil</div>
            <div class="settings-row-sub">Coming soon</div>
          </div>
          <button class="download-btn" onclick="showToast('Tamil coming soon!')">Download</button>
        </div>
      </div>

      <div class="settings-label">App Info</div>
      <div class="settings-card">
        <div class="settings-row">
          <div class="settings-row-left">
            <div class="settings-row-title">Version</div>
          </div>
          <span style="font-size:13px;font-weight:700;color:var(--text-muted)">1.0.0</span>
        </div>
        <div class="settings-row">
          <div class="settings-row-left">
            <div class="settings-row-title">Data Source</div>
            <div class="settings-row-sub">learnmarathiwithkaushik.com</div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- BOTTOM NAV -->
  <nav class="bottom-nav">
    <div class="nav-item active" id="nav-home" onclick="switchTab('home')">
      <span class="nav-icon">ğŸ </span>
      <span class="nav-label">Home</span>
    </div>
    <div class="nav-item" id="nav-dictionary" onclick="switchTab('dictionary')">
      <span class="nav-icon">ğŸ“–</span>
      <span class="nav-label">Dictionary</span>
    </div>
    <div class="nav-item" id="nav-chapters" onclick="switchTab('chapters')">
      <span class="nav-icon">ğŸ“š</span>
      <span class="nav-label">Lessons</span>
    </div>
    <div class="nav-item" id="nav-saved" onclick="switchTab('saved')">
      <span class="nav-icon">ğŸ”–</span>
      <span class="nav-label">Saved</span>
    </div>
    <div class="nav-item" id="nav-settings" onclick="switchTab('settings')">
      <span class="nav-icon">âš™ï¸</span>
      <span class="nav-label">Settings</span>
    </div>
  </nav>

  <div class="toast" id="toast"></div>
</div>

<script>
// ===== DATA =====
const PHRASES = {
  greetings: {
    name: "Greetings",
    color: "#2B6CB0",
    icon: "ğŸ‘‹",
    phrases: [
      { en: "Hello / Hi", mr: "à¤¨à¤®à¤¸à¥à¤•à¤¾à¤°", roman: "NamaskÄr", hint: "Formal greeting" },
      { en: "Good morning", mr: "à¤¶à¥à¤­ à¤¸à¤•à¤¾à¤³", roman: "Shubh sakÄá¸·", hint: "" },
      { en: "Good evening", mr: "à¤¶à¥à¤­ à¤¸à¤‚à¤§à¥à¤¯à¤¾à¤•à¤¾à¤³", roman: "Shubh sandhyÄkÄá¸·", hint: "" },
      { en: "Good night", mr: "à¤¶à¥à¤­ à¤°à¤¾à¤¤à¥à¤°à¥€", roman: "Shubh rÄtri", hint: "" },
      { en: "How are you?", mr: "à¤¤à¥à¤®à¥à¤¹à¥€ à¤•à¤¸à¥‡ à¤†à¤¹à¤¾à¤¤?", roman: "TumhÄ« kase ÄhÄt?", hint: "" },
      { en: "I am fine", mr: "à¤®à¥€ à¤ à¥€à¤• à¤†à¤¹à¥‡", roman: "MÄ« á¹­hÄ«k Ähe", hint: "" },
      { en: "What is your name?", mr: "à¤¤à¥à¤®à¤šà¥‡ à¤¨à¤¾à¤µ à¤•à¤¾à¤¯ à¤†à¤¹à¥‡?", roman: "Tumche nÄv kÄy Ähe?", hint: "" },
      { en: "My name is...", mr: "à¤®à¤¾à¤à¥‡ à¤¨à¤¾à¤µ ... à¤†à¤¹à¥‡", roman: "MÄjhe nÄv ... Ähe", hint: "" },
      { en: "Nice to meet you", mr: "à¤¤à¥à¤®à¥à¤¹à¤¾à¤²à¤¾ à¤­à¥‡à¤Ÿà¥‚à¤¨ à¤†à¤¨à¤‚à¤¦ à¤à¤¾à¤²à¤¾", roman: "TumhÄlÄ bheá¹­un Änand jhÄlÄ", hint: "" },
      { en: "Thank you", mr: "à¤§à¤¨à¥à¤¯à¤µà¤¾à¤¦", roman: "DhanyavÄd", hint: "Very common" },
      { en: "Please", mr: "à¤•à¥ƒà¤ªà¤¯à¤¾", roman: "Ká¹›payÄ", hint: "" },
      { en: "Sorry / Excuse me", mr: "à¤®à¤¾à¤« à¤•à¤°à¤¾", roman: "MÄf karÄ", hint: "" },
    ]
  },
  travel: {
    name: "Travel",
    color: "#D69E2E",
    icon: "ğŸš—",
    phrases: [
      { en: "How much to go here?", mr: "à¤­à¤¾à¤Š, à¤‡à¤¥à¥‡ à¤œà¤¾à¤£à¥à¤¯à¤¾à¤šà¥‡ à¤•à¤¿à¤¤à¥€ à¤ªà¥ˆà¤¸à¥‡ à¤˜à¥‡à¤£à¤¾à¤°?", roman: "BhÄu, ithe jÄá¹‡yÄce kitÄ« paise gheá¹‡Är?", hint: "Auto/Taxi fare" },
      { en: "Take me to the station", mr: "à¤®à¤²à¤¾ à¤¸à¥à¤Ÿà¥‡à¤¶à¤¨à¤²à¤¾ à¤¨à¥à¤¯à¤¾", roman: "MalÄ steÅ›analÄ nyÄ", hint: "" },
      { en: "Where is the bus stop?", mr: "à¤¬à¤¸ à¤¸à¥à¤Ÿà¥‰à¤ª à¤•à¥à¤ à¥‡ à¤†à¤¹à¥‡?", roman: "Bas sá¹­op kuá¹­he Ähe?", hint: "" },
      { en: "Stop here", mr: "à¤‡à¤¥à¥‡à¤š à¤¥à¤¾à¤‚à¤¬à¤¾", roman: "Ithe thÄmbÄ", hint: "Tell driver to stop" },
      { en: "How far is it?", mr: "à¤•à¤¿à¤¤à¥€ à¤¦à¥‚à¤° à¤†à¤¹à¥‡?", roman: "KitÄ« dÅ«r Ähe?", hint: "" },
      { en: "Turn left", mr: "à¤¡à¤¾à¤µà¥€à¤•à¤¡à¥‡ à¤µà¤³à¤¾", roman: "á¸ŒÄvÄ«kaá¸e vaá¸·Ä", hint: "" },
      { en: "Turn right", mr: "à¤‰à¤œà¤µà¥€à¤•à¤¡à¥‡ à¤µà¤³à¤¾", roman: "UjavÄ«kaá¸e vaá¸·Ä", hint: "" },
      { en: "Go straight", mr: "à¤¸à¤°à¤³ à¤œà¤¾", roman: "Saraá¸· jÄ", hint: "" },
      { en: "I am lost", mr: "à¤®à¥€ à¤¹à¤°à¤µà¤²à¥‹ à¤†à¤¹à¥‡", roman: "MÄ« harvalÅ Ähe", hint: "" },
      { en: "Where is the hospital?", mr: "à¤¦à¤µà¤¾à¤–à¤¾à¤¨à¤¾ à¤•à¥à¤ à¥‡ à¤†à¤¹à¥‡?", roman: "DavÄkhÄnÄ kuá¹­he Ähe?", hint: "" },
      { en: "Is this the right road?", mr: "à¤¹à¤¾ à¤¬à¤°à¥‹à¤¬à¤° à¤°à¤¸à¥à¤¤à¤¾ à¤†à¤¹à¥‡ à¤•à¤¾?", roman: "HÄ barÅbar rastÄ Ähe kÄ?", hint: "" },
      { en: "Please drive slowly", mr: "à¤¹à¤³à¥‚ à¤šà¤¾à¤²à¤µà¤¾", roman: "Haá¸·Å« cÄlavÄ", hint: "" },
      { en: "Where is the market?", mr: "à¤¬à¤¾à¤œà¤¾à¤° à¤•à¥à¤ à¥‡ à¤†à¤¹à¥‡?", roman: "BÄjÄr kuá¹­he Ähe?", hint: "" },
      { en: "How much is the ticket?", mr: "à¤¤à¤¿à¤•à¤¿à¤Ÿà¤¾à¤šà¥‡ à¤•à¤¿à¤¤à¥€ à¤ªà¥ˆà¤¸à¥‡?", roman: "Tikaá¹­Äce kitÄ« paise?", hint: "" },
      { en: "I want to go to...", mr: "à¤®à¤²à¤¾ ... à¤²à¤¾ à¤œà¤¾à¤¯à¤šà¥‡ à¤†à¤¹à¥‡", roman: "MalÄ ... lÄ jÄyace Ähe", hint: "" },
      { en: "Wait here", mr: "à¤‡à¤¥à¥‡ à¤¥à¤¾à¤‚à¤¬à¤¾", roman: "Ithe thÄmbÄ", hint: "" },
      { en: "Can you come back later?", mr: "à¤¨à¤‚à¤¤à¤° à¤¯à¤¾à¤² à¤•à¤¾?", roman: "Nantara yÄl kÄ?", hint: "" },
      { en: "Take the highway", mr: "à¤¹à¤¾à¤¯à¤µà¥‡ à¤˜à¥à¤¯à¤¾", roman: "HÄyave ghyÄ", hint: "" },
    ]
  },
  food: {
    name: "Food & Dining",
    color: "#C05621",
    icon: "ğŸ½ï¸",
    phrases: [
      { en: "What do you have to eat?", mr: "à¤œà¥‡à¤µà¤¾à¤¯à¤²à¤¾ à¤•à¤¾à¤¯ à¤†à¤¹à¥‡?", roman: "JevÄyalÄ kÄy Ähe?", hint: "" },
      { en: "I am hungry", mr: "à¤®à¤²à¤¾ à¤­à¥‚à¤• à¤²à¤¾à¤—à¤²à¥€ à¤†à¤¹à¥‡", roman: "MalÄ bhÅ«k lÄgalÄ« Ähe", hint: "" },
      { en: "The food is very tasty", mr: "à¤œà¥‡à¤µà¤£ à¤–à¥‚à¤ª à¤šà¤µà¤¿à¤·à¥à¤Ÿ à¤†à¤¹à¥‡", roman: "Jevaá¹‡ khÅ«p caviá¹£á¹­ Ähe", hint: "" },
      { en: "Give me water please", mr: "à¤®à¤²à¤¾ à¤ªà¤¾à¤£à¥€ à¤¦à¥à¤¯à¤¾", roman: "MalÄ pÄá¹‡Ä« dyÄ", hint: "" },
      { en: "I don't eat meat", mr: "à¤®à¥€ à¤®à¤¾à¤‚à¤¸ à¤–à¤¾à¤¤ à¤¨à¤¾à¤¹à¥€", roman: "MÄ« mÄns khÄt nÄhÄ«", hint: "" },
      { en: "The bill please", mr: "à¤¬à¤¿à¤² à¤†à¤£à¤¾", roman: "Bil Äá¹‡Ä", hint: "" },
      { en: "Is it spicy?", mr: "à¤¹à¥‡ à¤¤à¤¿à¤–à¤Ÿ à¤†à¤¹à¥‡ à¤•à¤¾?", roman: "He tikhaá¹­ Ähe kÄ?", hint: "" },
      { en: "Less spicy please", mr: "à¤•à¤®à¥€ à¤¤à¤¿à¤–à¤Ÿ à¤•à¤°à¤¾", roman: "KamÄ« tikhaá¹­ karÄ", hint: "" },
      { en: "One more serving", mr: "à¤†à¤£à¤–à¥€ à¤à¤• à¤µà¤¾à¤¢à¤¾", roman: "Ä€á¹‡akhÄ« ek vÄá¸hÄ", hint: "" },
      { en: "Do you have veg options?", mr: "à¤¶à¤¾à¤•à¤¾à¤¹à¤¾à¤°à¥€ à¤•à¤¾à¤¹à¥€ à¤†à¤¹à¥‡ à¤•à¤¾?", roman: "ÅšÄkÄhÄrÄ« kÄhÄ« Ähe kÄ?", hint: "" },
      { en: "Very delicious!", mr: "à¤–à¥‚à¤ª à¤›à¤¾à¤¨!", roman: "KhÅ«p chÄn!", hint: "" },
      { en: "I am full", mr: "à¤®à¤¾à¤à¥‡ à¤ªà¥‹à¤Ÿ à¤­à¤°à¤²à¥‡", roman: "MÄjhe poá¹­ bharale", hint: "" },
      { en: "Can I get tea?", mr: "à¤šà¤¹à¤¾ à¤®à¤¿à¤³à¥‡à¤² à¤•à¤¾?", roman: "CahÄ miá¸·el kÄ?", hint: "" },
      { en: "No sugar please", mr: "à¤¸à¤¾à¤–à¤° à¤¨à¤•à¥‹", roman: "SÄkhar nakÅ", hint: "" },
      { en: "Pack it please", mr: "à¤ªà¤¾à¤°à¥à¤¸à¤² à¤•à¤°à¤¾", roman: "PÄrsal karÄ", hint: "Takeaway" },
    ]
  },
  shopping: {
    name: "Shopping",
    color: "#805AD5",
    icon: "ğŸ›ï¸",
    phrases: [
      { en: "How much does this cost?", mr: "à¤¹à¥‡ à¤•à¤¿à¤¤à¥€ à¤°à¥à¤ªà¤¯à¤¾à¤‚à¤¨à¤¾ à¤†à¤¹à¥‡?", roman: "He kitÄ« rupayÄnnÄ Ähe?", hint: "" },
      { en: "Give me a discount", mr: "à¤¥à¥‹à¤¡à¥‡ à¤•à¤®à¥€ à¤•à¤°à¤¾", roman: "Thoá¸e kamÄ« karÄ", hint: "Ask for discount" },
      { en: "Do you have a smaller size?", mr: "à¤²à¤¹à¤¾à¤¨ à¤¸à¤¾à¤‡à¤œ à¤†à¤¹à¥‡ à¤•à¤¾?", roman: "LahÄn sÄij Ähe kÄ?", hint: "" },
      { en: "I'll take this", mr: "à¤®à¤²à¤¾ à¤¹à¥‡ à¤¹à¤µà¥‡ à¤†à¤¹à¥‡", roman: "MalÄ he have Ähe", hint: "" },
      { en: "This is too expensive", mr: "à¤¹à¥‡ à¤–à¥‚à¤ª à¤®à¤¹à¤¾à¤— à¤†à¤¹à¥‡", roman: "He khÅ«p mahÄg Ähe", hint: "" },
      { en: "Final price?", mr: "à¤¶à¥‡à¤µà¤Ÿà¤šà¥€ à¤•à¤¿à¤‚à¤®à¤¤ à¤•à¤¿à¤¤à¥€?", roman: "Åševaá¹­acÄ« kimmat kitÄ«?", hint: "" },
      { en: "I'll come back later", mr: "à¤®à¥€ à¤¨à¤‚à¤¤à¤° à¤¯à¥‡à¤¤à¥‹", roman: "MÄ« nantar yetÅ", hint: "" },
      { en: "Do you accept card?", mr: "à¤•à¤¾à¤°à¥à¤¡ à¤šà¤¾à¤²à¤¤à¥‡ à¤•à¤¾?", roman: "KÄrá¸ cÄlate kÄ?", hint: "" },
      { en: "Give me a bag", mr: "à¤ªà¤¿à¤¶à¤µà¥€ à¤¦à¥à¤¯à¤¾", roman: "PiÅ›avÄ« dyÄ", hint: "" },
      { en: "Do you have this in another color?", mr: "à¤¦à¥à¤¸à¤±à¥à¤¯à¤¾ à¤°à¤‚à¤—à¤¾à¤¤ à¤†à¤¹à¥‡ à¤•à¤¾?", roman: "Dusaá¹›yÄ rangÄt Ähe kÄ?", hint: "" },
    ]
  },
  emergency: {
    name: "Emergency",
    color: "#E53E3E",
    icon: "ğŸš¨",
    phrases: [
      { en: "Help!", mr: "à¤®à¤¦à¤¤ à¤•à¤°à¤¾!", roman: "Madat karÄ!", hint: "Urgent" },
      { en: "Call the police", mr: "à¤ªà¥‹à¤²à¤¿à¤¸à¤¾à¤‚à¤¨à¤¾ à¤¬à¥‹à¤²à¤µà¤¾", roman: "PolisÄnnÄ bolavÄ", hint: "" },
      { en: "I need a doctor", mr: "à¤®à¤²à¤¾ à¤¡à¥‰à¤•à¥à¤Ÿà¤° à¤¹à¤µà¥‡ à¤†à¤¹à¥‡à¤¤", roman: "MalÄ á¸Åká¹­ar have Ähet", hint: "" },
      { en: "There is a fire!", mr: "à¤†à¤— à¤²à¤¾à¤—à¤²à¥€!", roman: "Ä€g lÄgalÄ«!", hint: "" },
      { en: "I have been robbed", mr: "à¤®à¤¾à¤à¥€ à¤šà¥‹à¤°à¥€ à¤à¤¾à¤²à¥€", roman: "MÄjhÄ« corÄ« jhÄlÄ«", hint: "" },
      { en: "I am not feeling well", mr: "à¤®à¤²à¤¾ à¤¬à¤°à¥‡ à¤µà¤¾à¤Ÿà¤¤ à¤¨à¤¾à¤¹à¥€", roman: "MalÄ bare vÄá¹­at nÄhÄ«", hint: "" },
      { en: "Take me to hospital", mr: "à¤®à¤²à¤¾ à¤°à¥à¤—à¥à¤£à¤¾à¤²à¤¯à¤¾à¤¤ à¤¨à¥à¤¯à¤¾", roman: "MalÄ rugá¹‡ÄlayÄt nyÄ", hint: "" },
      { en: "I lost my phone", mr: "à¤®à¤¾à¤à¤¾ à¤«à¥‹à¤¨ à¤¹à¤°à¤µà¤²à¤¾", roman: "MÄjhÄ phon haravalÄ", hint: "" },
    ]
  },
  numbers: {
    name: "Numbers",
    color: "#38A169",
    icon: "ğŸ”¢",
    phrases: [
      { en: "One (1)", mr: "à¤à¤•", roman: "Ek", hint: "" },
      { en: "Two (2)", mr: "à¤¦à¥‹à¤¨", roman: "Don", hint: "" },
      { en: "Three (3)", mr: "à¤¤à¥€à¤¨", roman: "TÄ«n", hint: "" },
      { en: "Four (4)", mr: "à¤šà¤¾à¤°", roman: "CÄr", hint: "" },
      { en: "Five (5)", mr: "à¤ªà¤¾à¤š", roman: "PÄc", hint: "" },
      { en: "Six (6)", mr: "à¤¸à¤¹à¤¾", roman: "SahÄ", hint: "" },
      { en: "Seven (7)", mr: "à¤¸à¤¾à¤¤", roman: "SÄt", hint: "" },
      { en: "Eight (8)", mr: "à¤†à¤ ", roman: "Ä€á¹­h", hint: "" },
      { en: "Nine (9)", mr: "à¤¨à¤Š", roman: "Na'Å«", hint: "" },
      { en: "Ten (10)", mr: "à¤¦à¤¹à¤¾", roman: "DahÄ", hint: "" },
      { en: "Twenty (20)", mr: "à¤µà¥€à¤¸", roman: "VÄ«s", hint: "" },
      { en: "Fifty (50)", mr: "à¤ªà¤¨à¥à¤¨à¤¾à¤¸", roman: "PannÄs", hint: "" },
      { en: "Hundred (100)", mr: "à¤¶à¤‚à¤­à¤°", roman: "Åšambhar", hint: "" },
      { en: "Thousand (1000)", mr: "à¤¹à¤œà¤¾à¤°", roman: "HajÄr", hint: "" },
      { en: "How many?", mr: "à¤•à¤¿à¤¤à¥€?", roman: "KitÄ«?", hint: "" },
      { en: "How much money?", mr: "à¤•à¤¿à¤¤à¥€ à¤ªà¥ˆà¤¸à¥‡?", roman: "KitÄ« paise?", hint: "" },
      { en: "Zero (0)", mr: "à¤¶à¥‚à¤¨à¥à¤¯", roman: "ÅšÅ«nya", hint: "" },
      { en: "First", mr: "à¤ªà¤¹à¤¿à¤²à¤¾", roman: "PahilÄ", hint: "" },
      { en: "Second", mr: "à¤¦à¥à¤¸à¤°à¤¾", roman: "DusarÄ", hint: "" },
      { en: "Last", mr: "à¤¶à¥‡à¤µà¤Ÿà¤šà¤¾", roman: "Åševaá¹­acÄ", hint: "" },
    ]
  }
};

const DICTIONARY = [
  { en: "Water", mr: "à¤ªà¤¾à¤£à¥€", roman: "PÄá¹‡Ä«" },
  { en: "Food", mr: "à¤œà¥‡à¤µà¤£", roman: "Jevaá¹‡" },
  { en: "House", mr: "à¤˜à¤°", roman: "Ghar" },
  { en: "Road", mr: "à¤°à¤¸à¥à¤¤à¤¾", roman: "RastÄ" },
  { en: "Money", mr: "à¤ªà¥ˆà¤¸à¥‡", roman: "Paise" },
  { en: "Time", mr: "à¤µà¥‡à¤³", roman: "Veá¸·" },
  { en: "Day", mr: "à¤¦à¤¿à¤µà¤¸", roman: "Divas" },
  { en: "Night", mr: "à¤°à¤¾à¤¤à¥à¤°", roman: "RÄtra" },
  { en: "Mother", mr: "à¤†à¤ˆ", roman: "Ä€Ä«" },
  { en: "Father", mr: "à¤¬à¤¾à¤¬à¤¾", roman: "BÄbÄ" },
  { en: "Brother", mr: "à¤­à¤¾à¤Š", roman: "BhÄÅ«" },
  { en: "Sister", mr: "à¤¤à¤¾à¤ˆ", roman: "TÄÄ«" },
  { en: "Friend", mr: "à¤®à¤¿à¤¤à¥à¤°", roman: "Mitra" },
  { en: "School", mr: "à¤¶à¤¾à¤³à¤¾", roman: "ÅšÄá¸·Ä" },
  { en: "Work", mr: "à¤•à¤¾à¤®", roman: "KÄm" },
  { en: "City", mr: "à¤¶à¤¹à¤°", roman: "Åšahar" },
  { en: "Village", mr: "à¤—à¤¾à¤µ", roman: "GÄv" },
  { en: "Morning", mr: "à¤¸à¤•à¤¾à¤³", roman: "SakÄá¸·" },
  { en: "Evening", mr: "à¤¸à¤‚à¤§à¥à¤¯à¤¾à¤•à¤¾à¤³", roman: "SandhyÄkÄá¸·" },
  { en: "Today", mr: "à¤†à¤œ", roman: "Ä€j" },
  { en: "Tomorrow", mr: "à¤‰à¤¦à¥à¤¯à¤¾", roman: "UdyÄ" },
  { en: "Yesterday", mr: "à¤•à¤¾à¤²", roman: "KÄl" },
  { en: "Yes", mr: "à¤¹à¥‹", roman: "Ho" },
  { en: "No", mr: "à¤¨à¤¾à¤¹à¥€", roman: "NÄhÄ«" },
  { en: "Good", mr: "à¤šà¤¾à¤‚à¤—à¤²à¥‡", roman: "CÄá¹…gale" },
  { en: "Bad", mr: "à¤µà¤¾à¤ˆà¤Ÿ", roman: "VÄÄ«á¹­" },
  { en: "Big", mr: "à¤®à¥‹à¤ à¥‡", roman: "Moá¹­he" },
  { en: "Small", mr: "à¤²à¤¹à¤¾à¤¨", roman: "LahÄn" },
  { en: "Hot", mr: "à¤—à¤°à¤®", roman: "Garam" },
  { en: "Cold", mr: "à¤¥à¤‚à¤¡", roman: "Thaá¹‡á¸" },
];

// ===== STATE =====
let currentTab = 'home';
let currentCategory = null;
let previousScreen = 'home';
let savedPhrases = JSON.parse(localStorage.getItem('savedPhrases') || '[]');
let currentPhrase = null;

// ===== NAVIGATION =====
// (switchTab is defined later after chapters logic, see bottom of script)

function openCategory(cat) {
  currentCategory = cat;
  previousScreen = 'home';
  const data = PHRASES[cat];
  document.getElementById('phrase-screen-title').textContent = data.icon + ' ' + data.name;
  document.getElementById('phrase-section-label').textContent = data.phrases.length + ' PHRASES';

  const list = document.getElementById('phrase-list');
  list.innerHTML = data.phrases.map((p, i) => `
    <div class="phrase-item" onclick="openPhrase('${cat}', ${i})">
      <div class="phrase-item-left">
        <div class="phrase-en">${p.en}</div>
        <div class="phrase-roman">${p.roman}</div>
      </div>
      <span class="phrase-arrow">â€º</span>
    </div>
  `).join('');

  document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
  document.getElementById('screen-phrases').classList.add('active');
}

function openPhrase(cat, idx) {
  const p = PHRASES[cat].phrases[idx];
  currentPhrase = p;
  previousScreen = currentTab === 'home' ? 'phrases' : currentTab;

  document.getElementById('result-input-display').textContent = p.en;
  document.getElementById('result-devanagari').textContent = p.mr;
  document.getElementById('result-roman').textContent = p.roman;

  const saveBtn = document.getElementById('save-btn');
  const isSaved = savedPhrases.some(s => s.mr === p.mr);
  saveBtn.textContent = isSaved ? 'âœ“ Saved!' : 'Save Phrase';
  saveBtn.className = 'save-btn' + (isSaved ? ' saved' : '');

  // Similar phrases from same category
  const similar = PHRASES[cat].phrases.filter((_, i) => i !== idx).slice(0, 3);
  document.getElementById('similar-phrases').innerHTML = similar.map((sp, i) => `
    <div class="phrase-item" onclick="openPhrase('${cat}', ${PHRASES[cat].phrases.indexOf(sp)})">
      <div class="phrase-item-left">
        <div class="phrase-en">${sp.en}</div>
        <div class="phrase-roman">${sp.roman}</div>
      </div>
      <span class="phrase-arrow">â€º</span>
    </div>
  `).join('');

  document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
  document.getElementById('screen-result').classList.add('active');
}

function goBack() {
  document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
  document.getElementById('screen-home').classList.add('active');
}

function goBackFromResult() {
  document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
  if (previousScreen === 'phrases') {
    document.getElementById('screen-phrases').classList.add('active');
  } else {
    document.getElementById('screen-' + (currentTab || 'home')).classList.add('active');
  }
}

// ===== SEARCH =====
function handleHomeSearch(val) {
  const resultsArea = document.getElementById('search-results-area');
  const categoriesArea = document.getElementById('categories-area');
  const resultsList = document.getElementById('search-results-list');

  if (!val.trim()) {
    resultsArea.style.display = 'none';
    categoriesArea.style.display = 'block';
    return;
  }

  resultsArea.style.display = 'block';
  categoriesArea.style.display = 'none';

  const query = val.toLowerCase();
  let results = [];

  Object.entries(PHRASES).forEach(([cat, data]) => {
    data.phrases.forEach((p, i) => {
      if (p.en.toLowerCase().includes(query) || p.roman.toLowerCase().includes(query) || p.mr.includes(val)) {
        results.push({ cat, idx: i, phrase: p });
      }
    });
  });

  DICTIONARY.forEach(d => {
    if (d.en.toLowerCase().includes(query) || d.roman.toLowerCase().includes(query)) {
      results.push({ dict: true, phrase: d });
    }
  });

  if (!results.length) {
    resultsList.innerHTML = '<div class="no-results">No results found for "' + val + '"</div>';
    return;
  }

  resultsList.innerHTML = results.slice(0, 15).map(r => `
    <div class="phrase-item" onclick="${r.dict ? `openDictItem(${JSON.stringify(r.phrase).replace(/"/g,"'")})` : `openPhrase('${r.cat}', ${r.idx})`}">
      <div class="phrase-item-left">
        <div class="phrase-en">${r.phrase.en}</div>
        <div class="phrase-roman">${r.phrase.roman}</div>
      </div>
      <div style="font-family:'Noto Sans Devanagari',sans-serif;font-size:14px;font-weight:700;color:var(--primary)">${r.phrase.mr}</div>
    </div>
  `).join('');
}

function openDictItem(p) {
  // Find which category it belongs to (or use a generic one)
  currentPhrase = p;
  document.getElementById('result-input-display').textContent = p.en;
  document.getElementById('result-devanagari').textContent = p.mr;
  document.getElementById('result-roman').textContent = p.roman;
  previousScreen = 'home';

  const saveBtn = document.getElementById('save-btn');
  const isSaved = savedPhrases.some(s => s.mr === p.mr);
  saveBtn.textContent = isSaved ? 'âœ“ Saved!' : 'Save Phrase';
  saveBtn.className = 'save-btn' + (isSaved ? ' saved' : '');

  document.getElementById('similar-phrases').innerHTML = '';

  document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
  document.getElementById('screen-result').classList.add('active');
}

// ===== DICTIONARY =====
function renderDict(query) {
  const list = document.getElementById('dict-list');
  const q = query.toLowerCase();
  const items = q
    ? DICTIONARY.filter(d => d.en.toLowerCase().includes(q) || d.roman.toLowerCase().includes(q))
    : DICTIONARY;

  list.innerHTML = items.map(d => `
    <div class="dict-item" onclick="openDictItem(${JSON.stringify(d).replace(/"/g,"'")})">
      <div class="dict-en">${d.en}</div>
      <div class="dict-mr">${d.mr}</div>
    </div>
  `).join('');
}

function handleDictSearch(val) { renderDict(val); }

// ===== SAVED =====
function savePhrase() {
  if (!currentPhrase) return;
  const isSaved = savedPhrases.some(s => s.mr === currentPhrase.mr);
  if (isSaved) {
    savedPhrases = savedPhrases.filter(s => s.mr !== currentPhrase.mr);
    showToast('Removed from saved');
    document.getElementById('save-btn').textContent = 'Save Phrase';
    document.getElementById('save-btn').className = 'save-btn';
  } else {
    savedPhrases.push(currentPhrase);
    showToast('Phrase saved! ğŸ”–');
    document.getElementById('save-btn').textContent = 'âœ“ Saved!';
    document.getElementById('save-btn').className = 'save-btn saved';
  }
  localStorage.setItem('savedPhrases', JSON.stringify(savedPhrases));
}

function renderSaved() {
  const wrap = document.getElementById('saved-list-wrap');
  if (!savedPhrases.length) {
    wrap.innerHTML = `
      <div class="empty-state">
        <div class="empty-icon">ğŸ”–</div>
        <div class="empty-title">No saved phrases yet</div>
        <div class="empty-sub">Tap "Save Phrase" on any phrase to bookmark it here</div>
      </div>`;
    return;
  }
  wrap.innerHTML = '<div class="phrase-list" style="padding: 0 20px;">' +
    savedPhrases.map((p, i) => `
      <div class="phrase-item" onclick="openSavedPhrase(${i})">
        <div class="phrase-item-left">
          <div class="phrase-en">${p.en}</div>
          <div class="phrase-roman">${p.roman}</div>
        </div>
        <div style="font-family:'Noto Sans Devanagari',sans-serif;font-size:14px;font-weight:700;color:var(--primary)">${p.mr}</div>
      </div>`).join('') + '</div>';
}

function openSavedPhrase(i) {
  const p = savedPhrases[i];
  currentPhrase = p;
  previousScreen = 'saved';

  document.getElementById('result-input-display').textContent = p.en;
  document.getElementById('result-devanagari').textContent = p.mr;
  document.getElementById('result-roman').textContent = p.roman;

  const saveBtn = document.getElementById('save-btn');
  saveBtn.textContent = 'âœ“ Saved!';
  saveBtn.className = 'save-btn saved';

  document.getElementById('similar-phrases').innerHTML = '';
  document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
  document.getElementById('screen-result').classList.add('active');
}

// ===== SPEAK =====
function speakMarathi() {
  if (!currentPhrase) return;
  if ('speechSynthesis' in window) {
    const utt = new SpeechSynthesisUtterance(currentPhrase.mr);
    utt.lang = 'mr-IN';
    utt.rate = 0.85;
    window.speechSynthesis.cancel();
    window.speechSynthesis.speak(utt);
    showToast('ğŸ”Š Playing...');
  } else {
    showToast('Speech not supported on this device');
  }
}

// ===== SETTINGS =====
let offlineEnabled = true;
function toggleOffline() {
  offlineEnabled = !offlineEnabled;
  const t = document.getElementById('offline-toggle');
  t.className = 'toggle' + (offlineEnabled ? '' : ' off');
  showToast(offlineEnabled ? 'Offline mode enabled' : 'Offline mode disabled');
}

// ===== TOAST =====
function showToast(msg) {
  const t = document.getElementById('toast');
  t.textContent = msg;
  t.classList.add('show');
  setTimeout(() => t.classList.remove('show'), 2200);
}


// ===== CHAPTERS (static data.json â€” no backend needed) =====
let allChapters = [];
let chaptersLoaded = false;

async function loadChapters() {
  if (chaptersLoaded) return;

  const loading = document.getElementById('chapters-loading');
  const error   = document.getElementById('chapters-error');
  const list    = document.getElementById('chapters-list');

  loading.style.display = 'block';
  error.style.display   = 'none';
  list.innerHTML        = '';

  try {
    const res = await fetch('/data.json');
    if (!res.ok) throw new Error('not found');
    allChapters   = await res.json();
    chaptersLoaded = true;
    renderChaptersList(allChapters);
  } catch(e) {
    loading.style.display = 'none';
    error.style.display   = 'block';
    document.getElementById('chapters-error').innerHTML = `
      <div style="font-size:36px;margin-bottom:12px;">âš ï¸</div>
      <div style="font-weight:800;color:var(--text);margin-bottom:6px;">data.json not found</div>
      <div style="font-size:12px;color:var(--text-muted);font-weight:600;">
        Run <code style="background:var(--border);padding:2px 6px;border-radius:4px;">python export_to_json.py</code>
        then place <code style="background:var(--border);padding:2px 6px;border-radius:4px;">data.json</code> in your project root
      </div>`;
  }
}

function renderChaptersList(chapters) {
  const loading = document.getElementById('chapters-loading');
  const list    = document.getElementById('chapters-list');
  loading.style.display = 'none';

  if (!chapters.length) {
    list.innerHTML = '<div class="no-results">No chapters found</div>';
    return;
  }

  list.innerHTML = chapters.map(ch => `
    <div class="dict-item" onclick="openChapter(${ch.id})" style="align-items:flex-start;gap:10px;">
      <div style="
        background:var(--primary-light);
        color:var(--primary);
        font-size:11px;font-weight:800;
        border-radius:6px;padding:3px 8px;
        white-space:nowrap;flex-shrink:0;margin-top:2px;
      ">#${ch.id}</div>
      <div style="flex:1;font-size:13px;font-weight:700;line-height:1.4;">${ch.title}</div>
      <div style="color:var(--primary);font-size:18px;flex-shrink:0;">â€º</div>
    </div>
  `).join('');
}

function handleChaptersSearch(val) {
  if (!chaptersLoaded) return;
  const q = val.trim().toLowerCase();
  const filtered = q
    ? allChapters.filter(ch =>
        ch.title.toLowerCase().includes(q) ||
        ch.content.toLowerCase().includes(q)
      )
    : allChapters;
  renderChaptersList(filtered);
}

function openChapter(id) {
  const ch = allChapters.find(c => c.id === id);
  if (!ch) return;

  document.getElementById('chapter-detail-back-label').textContent = 'Lessons';
  document.getElementById('chapter-detail-id').textContent    = ch.id;
  document.getElementById('chapter-detail-title').textContent = ch.title;
  document.getElementById('chapter-detail-body').textContent  = ch.content;
  document.getElementById('chapter-detail-link').href         = ch.url;

  document.getElementById('chapter-detail-loading').style.display = 'none';
  document.getElementById('chapter-detail-content').style.display = 'block';

  document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
  document.getElementById('screen-chapter-detail').classList.add('active');
}

function goBackFromChapter() {
  document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
  document.getElementById('screen-chapters').classList.add('active');
}

function switchTab(tab) {
  document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
  document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
  document.getElementById('screen-' + tab).classList.add('active');
  document.getElementById('nav-' + tab).classList.add('active');
  currentTab = tab;

  if (tab === 'dictionary') renderDict('');
  if (tab === 'saved') renderSaved();
  if (tab === 'chapters') loadChapters();
}


</script>
</body>
</html>
